<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class ExportExcel extends CI_Controller {
  
  
  public function __construct(){
    parent::__construct();
    $models = array(
      'AlltowerModel' => 'AlltowerModel',
      'SitePlanModel' => 'SitePlanModel'
    );
    $this->load->model($models);   
    $this->load->helper('url');
      // Load plugin PHPExcel nya
    include APPPATH.'third_party/PHPExcel/PHPExcel.php';
  }

 

  public function stackingplan(){

    $excel = new PHPExcel();

    $tower = 'TRB';
    $level = 20;
    $dataUnit = $this->SitePlanModel->getUnitLevel20($tower);  
    $data['menutower'] = $this->AlltowerModel->dataMenuTower();

    $count100 = $this->SitePlanModel->get100($tower,$level); 
    $count7090 = $this->SitePlanModel->get70_90($tower,$level); 
    $count4069 = $this->SitePlanModel->get40_69($tower,$level); 
    $count039 = $this->SitePlanModel->get0_39($tower,$level); 
    foreach($count100 as $row){
      $excel->setActiveSheetIndex(0)->setCellValue('BK1', $row['totUnit']);
    }
    foreach($count7090 as $row){
      $excel->setActiveSheetIndex(0)->setCellValue('BL1', $row['totUnit']);
    }

    foreach($count4069 as $row){
      $excel->setActiveSheetIndex(0)->setCellValue('BM1', $row['totUnit']);
    }

    foreach($count039 as $row){
      $excel->setActiveSheetIndex(0)->setCellValue('BN1', $row['totUnit']);
    }

    /* tahun 2021 */
    $count09_2021 = $this->SitePlanModel->getMonth92021($tower,$level); 
    foreach($count09_2021 as $row){
        $excel->setActiveSheetIndex(0)->setCellValue('BP2', $row['totUnit']);
        $excel->setActiveSheetIndex(0)->setCellValue('BP1', '09/2021');
        $excel->getActiveSheet()
        ->getStyle('BP1')
        ->applyFromArray(
            array(
                'fill' => array(
                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                    'color' => array('rgb' => '00FF00') 
                )
            )
        );
    }

    $count10_2021 = $this->SitePlanModel->getMonth102021($tower,$level); 
    foreach($count10_2021 as $row){
        $excel->setActiveSheetIndex(0)->setCellValue('BQ2', $row['totUnit']);
        $excel->setActiveSheetIndex(0)->setCellValue('BQ1', '10/2021');
        $excel->getActiveSheet()
        ->getStyle('BQ1')
        ->applyFromArray(
            array(
                'fill' => array(
                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                    'color' => array('rgb' => '00FFFF') 
                )
            )
        );
        
    }

    $count11_2021 = $this->SitePlanModel->getMonth112021($tower,$level); 
    foreach($count11_2021 as $row){
        $excel->setActiveSheetIndex(0)->setCellValue('BR1', '11/2021');
        $excel->setActiveSheetIndex(0)->setCellValue('BR2', $row['totUnit']);
        $excel->getActiveSheet()
        ->getStyle('BR1')
        ->applyFromArray(
            array(
                'fill' => array(
                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                    'color' => array('rgb' => '4682B4') 
                )
            )
        );
    }

    $count12_2021 = $this->SitePlanModel->getMonth122021($tower,$level); 
    foreach($count12_2021 as $row){
        $excel->setActiveSheetIndex(0)->setCellValue('BS1', '12/2021');
        $excel->setActiveSheetIndex(0)->setCellValue('BS2', $row['totUnit']);
        $excel->getActiveSheet()
        ->getStyle('BS1')
        ->applyFromArray(
            array(
                'fill' => array(
                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                    'color' => array('rgb' => '87CEFA') 
                )
            )
        );
    }

    /* grace periode tahun 2022 */
    foreach (range(1, 12) as $nummonth){
        $countMonth = $this->SitePlanModel->getMonthGracePeriode($tower,$level,$nummonth,'2022'); 
        if($nummonth == 1){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BT1', '01/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BT2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BT1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '7B68EE') 
                            )
                        )
                    );

            }
        } else if($nummonth == 2){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BU1', '02/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BU2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BU1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '9370DB') 
                            )
                        )
                    );

            }
        } else if($nummonth == 3){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BV1', '03/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BV2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BV1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '8B008B') 
                            )
                        )
                    );

            }
        } else if($nummonth == 4){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BW1', '04/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BW2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BW1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '9400D3') 
                            )
                        )
                    );

            }
        } else if($nummonth == 5){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BX1', '05/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BX2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BX1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'DDA0DD') 
                            )
                        )
                    );

            }
        }  else if($nummonth == 6){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BY1', '06/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BY2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BY1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'FF00FF') 
                            )
                        )
                    );

            }
        } else if($nummonth == 7){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('BZ1', '07/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('BZ2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('BZ1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'FAEBD7') 
                            )
                        )
                    );

            }
        } else if($nummonth == 8){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CA1', '08/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('CA2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CA1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'F5DEB3') 
                            )
                        )
                    );

            }
        } else if($nummonth == 9){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CB1', '09/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('CB2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CB1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'FFFFE0') 
                            )
                        )
                    );

            }
        } else if($nummonth == 10){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CC1', '10/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('CC2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CC1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'D2691E') 
                            )
                        )
                    );

            }
        } else if($nummonth == 11){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CD1', '11/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('CD2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CD1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'BC8F8F') 
                            )
                        )
                    );

            }
        } else if($nummonth == 12){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CE1', '12/2022');
                    $excel->setActiveSheetIndex(0)->setCellValue('CE2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CE1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '708090') 
                            )
                        )
                    );

            }
        } 
    }


      /* grace periode tahun 2023 */
      foreach (range(1, 12) as $nummonth){
        $countMonth = $this->SitePlanModel->getMonthGracePeriode($tower,$level,$nummonth,'2023'); 
        if($nummonth == 1){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CF1', '01/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CF2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CF1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'E6E6FA') 
                            )
                        )
                    );

            }
        } else if($nummonth == 2){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CG1', '02/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CG2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CG1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'F0F8FF') 
                            )
                        )
                    );

            }
        } else if($nummonth == 3){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CH1', '03/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CH2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CH1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '808080') 
                            )
                        )
                    );

            }
        } else if($nummonth == 4){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CI1', '04/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CI2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CI1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '800000') 
                            )
                        )
                    );

            }
        } else if($nummonth == 5){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CJ1', '05/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CJ2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CJ1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'CD5C5C') 
                            )
                        )
                    );

            }
        }  else if($nummonth == 6){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CK1', '06/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CK2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CK1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'E9967A') 
                            )
                        )
                    );

            }
        } else if($nummonth == 7){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CL1', '07/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CL2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CL1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'FF8C00') 
                            )
                        )
                    );

            }
        } else if($nummonth == 8){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CM1', '08/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CM2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CM1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'DAA520') 
                            )
                        )
                    );

            }
        } else if($nummonth == 9){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CN1', '09/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CN2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CN1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'BDB76B') 
                            )
                        )
                    );

            }
        } else if($nummonth == 10){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CO1', '10/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CO2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CO1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => 'D2691E') 
                            )
                        )
                    );

            }
        } else if($nummonth == 11){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CP1', '11/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CP2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CP1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '556B2F') 
                            )
                        )
                    );

            }
        } else if($nummonth == 12){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('CQ1', '12/2023');
                    $excel->setActiveSheetIndex(0)->setCellValue('CQ2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('CQ1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '00FF7F') 
                            )
                        )
                    );

            }
        } 
    }


          /* grace periode tahun 2024 */
          foreach (range(1, 12) as $nummonth){
            $countMonth = $this->SitePlanModel->getMonthGracePeriode($tower,$level,$nummonth,'2024'); 
            if($nummonth == 1){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CR1', '01/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CR2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CR1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FF7F50') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 2){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CS1', '02/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CS2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CS1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'E9967A') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 3){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CT1', '03/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CT2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CT1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FA8072') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 4){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CU1', '04/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CU2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CU1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FFA500') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 5){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CV1', '05/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CV2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CV1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'B8860B') 
                                )
                            )
                        );
    
                }
            }  else if($nummonth == 6){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CW1', '06/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CW2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CW1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '808000') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 7){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CX1', '07/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CX2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CX1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '228B22') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 8){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CY1', '08/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CY2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CY1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '66CDAA') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 9){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('CZ1', '09/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('CZ2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('CZ1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'E0FFFF') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 10){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('DA1', '10/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('DA2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('DA1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '4682B4') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 11){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('DB1', '11/2024');
                        $excel->setActiveSheetIndex(0)->setCellValue('DB2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('DB1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '1E90FF') 
                                )
                            )
                        );
    
                }
            } else if($nummonth == 12){
                foreach($countMonth as $row){
                        $excel->setActiveSheetIndex(0)->setCellValue('DC1', '12/2023');
                        $excel->setActiveSheetIndex(0)->setCellValue('DC2', $row['totUnit']);
                        $excel->getActiveSheet()
                        ->getStyle('DC1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '4B0082') 
                                )
                            )
                        );
    
                }
            } 
        }

    /* grace periode tahun 2025 */
    foreach (range(1, 12) as $nummonth){
        $countMonth = $this->SitePlanModel->getMonthGracePeriode($tower,$level,$nummonth,'2025'); 
        if($nummonth == 1){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('DD1', '01/2025');
                    $excel->setActiveSheetIndex(0)->setCellValue('DD2', $row['totUnit']);
                    $excel->getActiveSheet()
                        ->getStyle('DD1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FA8072') 
                                )
                            )
                        );
                   

            }
        } else if($nummonth == 2){
            foreach($countMonth as $row){
                    $excel->setActiveSheetIndex(0)->setCellValue('DE1', '02/2025');
                    $excel->setActiveSheetIndex(0)->setCellValue('DE2', $row['totUnit']);
                    $excel->getActiveSheet()
                    ->getStyle('DE1')
                    ->applyFromArray(
                        array(
                            'fill' => array(
                                'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                'color' => array('rgb' => '8B0000') 
                            )
                        )
                    );
                   

            }
        } 
    }





  
    foreach (range(1, 80) as $number) { 
        if($number != 4 AND $number != 13 AND $number != 14 AND $number != 24 AND $number != 34 AND $number != 40 AND $number != 41 AND $number != 42 AND $number != 43 AND $number != 44 AND $number != 45 AND $number != 46 AND $number != 47 AND $number != 48 AND $number != 49 AND $number != 54 AND $number != 64 AND $number != 74){
            foreach($dataUnit as $data){
                $key = substr($data['unit'],-2);
                switch ($key) {
                    case 01:
                      $excel->setActiveSheetIndex(0)->setCellValue('A1', $data['unit']);
                      $excel->setActiveSheetIndex(0)->setCellValue('A2', $data['date_grace_periode']);
                      $payment = str_replace("%","", $data['penerimaan']);
                      $mGracePeriode = $data['mGracePeriode'];
                      $yGracePeriode = $data['yGracePeriode'];
                      /*color grace periode */
                       /*tahun 2021*/
                      if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '00FF00') 
                                )
                            )
                        );
                      } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '00FFFF') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '4682B4') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '87CEFA') 
                                )
                            )
                        );
                       } 
                       /*tahun 2022*/
                       else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '7B68EE') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '9370DB') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '8B008B') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '9400D3') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'DDA0DD') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FF00FF') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FAEBD7') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5DEB3') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FFFFE0') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'D2691E') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'BC8F8F') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '708090') 
                                )
                            )
                        );
                       } 
                       
                       
                       /* tahun 2023*/
                       else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'E6E6FA') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F0F8FF') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '808080') 
                                )
                            )
                        );
                       }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '800000') 
                                )
                            )
                        );
                       }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'CD5C5C') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'E9967A') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'FF8C00') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'DAA520') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'BDB76B') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'D2691E') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '556B2F') 
                                )
                            )
                        );
                       } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                        $excel->getActiveSheet()
                        ->getStyle('A2')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '00FF7F') 
                                )
                            )
                        );
                       } 
                        /* tahun 2024*/
                        else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'FF7F50') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'E9967A') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'FA8072') 
                                    )
                                )
                            );
                           }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'FFA500') 
                                    )
                                )
                            );
                           }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'B8860B') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '808000') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '228B22') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '66CDAA') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'E0FFFF') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '4682B4') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '1E90FF') 
                                    )
                                )
                            );
                           } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => '4B0082') 
                                    )
                                )
                            );
                           } 

                           /*tahun 2025 */

                           else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                            $excel->getActiveSheet()
                            ->getStyle('A2')
                            ->applyFromArray(
                                array(
                                    'fill' => array(
                                        'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                        'color' => array('rgb' => 'F5F5F5') 
                                    )
                                )
                            );
                           } 


                       /*payment*/

                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('A1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('A1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('A1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('A1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 02:
                        $excel->setActiveSheetIndex(0)->setCellValue('B1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('B2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('B2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('B2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 


                      /*payment*/
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('B1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('B1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('B1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('B1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 03:
                        $excel->setActiveSheetIndex(0)->setCellValue('C1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('C2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('C2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('C2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                       /*Payment */      
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('C1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('C1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('C1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('C1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 05:
                        $excel->setActiveSheetIndex(0)->setCellValue('D1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('D2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('D2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('D2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 

                      /* Payment */
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('D1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('D1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('D1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('D1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 06:
                        $excel->setActiveSheetIndex(0)->setCellValue('E1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('E2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('E2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('E2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 

                      /* payment */       
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('E1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('E1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('E1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('E1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 07:

                        $excel->setActiveSheetIndex(0)->setCellValue('F1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('F2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('F2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('F2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             }   
                     
                      /*Payment */  
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('F1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('F1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('F1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('F1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 8:
                        $excel->setActiveSheetIndex(0)->setCellValue('G1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('G2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('G2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('G2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             }   
                      /* payment */
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('G1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('G1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('G1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('G1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 9:
                        $excel->setActiveSheetIndex(0)->setCellValue('H1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('H2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('H2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('H2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             }   
                      /* payment */
                      if($payment == 100){
                          
                        $excel->getActiveSheet()
                        ->getStyle('H1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => '199904')
                                )
                            )
                        );
                      } else if ($payment >= 70){
            
                        $excel->getActiveSheet()
                        ->getStyle('H1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'F5E739')
                                )
                            )
                        );
            
                      } else if ($payment <= 39){
            
                        $excel->getActiveSheet()
                        ->getStyle('H1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'EC0B34')
                                )
                            )
                        );
            
                      } else if ($payment >= 40){
            
                        $excel->getActiveSheet()
                        ->getStyle('H1')
                        ->applyFromArray(
                            array(
                                'fill' => array(
                                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                    'color' => array('rgb' => 'ffe6e6')
                                )
                            )
                        );
            
                      }
                        break;
                    case 10:
                        $excel->setActiveSheetIndex(0)->setCellValue('I1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('I2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('I2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('I2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      /* payment */
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('I1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('I1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('I1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('I1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 11:
                        $excel->setActiveSheetIndex(0)->setCellValue('J1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('J2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('J2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('J2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                     
                      /* payment */  
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('J1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('J1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('J1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('J1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 12:
                        $excel->setActiveSheetIndex(0)->setCellValue('K1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('K2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('K2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('K2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                             
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('K1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('K1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('K1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('K1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 15:
                        $excel->setActiveSheetIndex(0)->setCellValue('L1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('L2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('L2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('L2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 

                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('L1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('L1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('L1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('L1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 16:
                        $excel->setActiveSheetIndex(0)->setCellValue('M1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('M2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('M2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('M2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 

                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('M1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('M1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('M1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('M1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 17:
                        $excel->setActiveSheetIndex(0)->setCellValue('N1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('N2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('N2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('N2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                       /* payment */      
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('N1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('N1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('N1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('N1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 18:
                        $excel->setActiveSheetIndex(0)->setCellValue('O1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('O2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('O2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('O2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('O1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('O1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('O1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('O1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 19:
                        $excel->setActiveSheetIndex(0)->setCellValue('P1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('P2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('P2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('P2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('P1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('P1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('P1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('P1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 20:
                        $excel->setActiveSheetIndex(0)->setCellValue('Q1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('Q2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Q2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('Q2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('Q1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('Q1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('Q1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('Q1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 21:
                        $excel->setActiveSheetIndex(0)->setCellValue('R1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('R2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('R2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('R2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                             
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('R1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('R1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('R1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('R1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 22:
                        $excel->setActiveSheetIndex(0)->setCellValue('S1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('S2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('S2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('S2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('S1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('S1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('S1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('S1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 23:
                        $excel->setActiveSheetIndex(0)->setCellValue('T1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('T2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('T2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('T2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('T1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('T1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('T1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('T1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;   
                    case 25:
                        $excel->setActiveSheetIndex(0)->setCellValue('U1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('U2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('U2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('U2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('U1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('U1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('U1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('U1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 26:
                        $excel->setActiveSheetIndex(0)->setCellValue('V1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('V2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('V2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('V2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('V1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('V1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('V1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('V1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 27:
                        $excel->setActiveSheetIndex(0)->setCellValue('W1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('W2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('W2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('W2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('W1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('W1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('W1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('W1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 28:
                        $excel->setActiveSheetIndex(0)->setCellValue('X1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('X2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('X2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('X2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('X1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('X1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('X1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('X1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break; 
                    case 29:
                        $excel->setActiveSheetIndex(0)->setCellValue('Y1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('Y2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Y2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('Y2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('Y1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('Y1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('Y1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('Y1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 30:
                        $excel->setActiveSheetIndex(0)->setCellValue('Z1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('Z2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('Z2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('Z2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('Z1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('Z1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('Z1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('Z1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;  
                    case 31:
                        $excel->setActiveSheetIndex(0)->setCellValue('AA1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AA2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 32:
                        $excel->setActiveSheetIndex(0)->setCellValue('AB1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AB2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 33:
                        $excel->setActiveSheetIndex(0)->setCellValue('AC1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AC2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 35:
                        $excel->setActiveSheetIndex(0)->setCellValue('AD1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AD2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 36:
                        $excel->setActiveSheetIndex(0)->setCellValue('AE1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AE2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 37:
                        $excel->setActiveSheetIndex(0)->setCellValue('AF1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AF2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 38:
                        $excel->setActiveSheetIndex(0)->setCellValue('AG1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AG2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 39:
                        $excel->setActiveSheetIndex(0)->setCellValue('AH1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AH2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 50:
                        $excel->setActiveSheetIndex(0)->setCellValue('AI1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AI2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 51:
                        $excel->setActiveSheetIndex(0)->setCellValue('AJ1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AJ2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 52:
                        $excel->setActiveSheetIndex(0)->setCellValue('AK1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AK2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AK2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AK2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AK1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AK1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AK1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AK1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 53:
                        $excel->setActiveSheetIndex(0)->setCellValue('AL1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AL2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AL2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AL2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AL1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AL1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AL1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AL1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 55:
                        $excel->setActiveSheetIndex(0)->setCellValue('AM1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AM2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AM2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AM2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AM1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AM1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AM1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AM1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 56:
                        $excel->setActiveSheetIndex(0)->setCellValue('AN1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AN2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AN2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AN2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AN1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AN1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AN1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AN1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 57:
                        $excel->setActiveSheetIndex(0)->setCellValue('AO1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AO2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AO2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AO2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AO1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AO1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AO1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AO1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 58:
                        $excel->setActiveSheetIndex(0)->setCellValue('AP1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AP2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AP2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AP2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AP1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AP1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AP1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AP1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 59:
                        $excel->setActiveSheetIndex(0)->setCellValue('AQ1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AQ2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AQ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AQ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AQ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AQ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AQ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AQ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 60:
                        $excel->setActiveSheetIndex(0)->setCellValue('AR1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AR2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AR2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AR2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AR1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AR1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AR1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AR1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 61:
                        $excel->setActiveSheetIndex(0)->setCellValue('AS1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AS2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AS2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AS2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AS1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AS1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AS1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AS1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 62:
                        $excel->setActiveSheetIndex(0)->setCellValue('AT1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AT2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AT2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AT2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AT1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AT1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AT1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AT1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;   
                    case 63:
                        $excel->setActiveSheetIndex(0)->setCellValue('AU1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AU2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AU2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AU2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AU1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AU1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AU1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AU1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 65:
                        $excel->setActiveSheetIndex(0)->setCellValue('AV1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AV2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AV2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AV2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AV1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AV1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AV1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AV1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 66:
                        $excel->setActiveSheetIndex(0)->setCellValue('AW1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AW2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AW2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AW2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AW1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AW1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AW1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AW1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 67:
                        $excel->setActiveSheetIndex(0)->setCellValue('AX1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AX2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AX2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AX2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AX1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AX1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AX1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AX1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break; 
                    case 68:
                        $excel->setActiveSheetIndex(0)->setCellValue('AY1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AY2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AY2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AY2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AY1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AY1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AY1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AY1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;
                    case 69:
                        $excel->setActiveSheetIndex(0)->setCellValue('AZ1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('AZ2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('AZ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('AZ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('AZ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('AZ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('AZ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('AZ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                        break;  
                    case 70:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BA1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BA2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BA2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BA2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BA1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;
                    case 71:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BB1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BB2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BB2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BB2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BB1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break; 
                    case 72:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BC1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BC2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BC2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BC2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BC1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;
                    case 73:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BD1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BD2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BD2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BD2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BD1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;           
                    case 75:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BE1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BE2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BE2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BE2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BE1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;  
                    case 76:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BF1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BF2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BF2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BF2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BF1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;
                    case 77:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BG1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BG2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BG2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BG2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BG1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break; 
                    case 78:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BH1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BH2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BH2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BH2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BH1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;
                    case 79:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BI1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BI2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BI2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BI2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BI1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;
                    case 80:    
                        $excel->setActiveSheetIndex(0)->setCellValue('BJ1', $data['unit']);
                        $excel->setActiveSheetIndex(0)->setCellValue('BJ2', $data['date_grace_periode']);
                        $payment = str_replace("%","", $data['penerimaan']);
                        $mGracePeriode = $data['mGracePeriode'];
                        $yGracePeriode = $data['yGracePeriode'];
                        /*color grace periode */
                         /*tahun 2021*/
                        if($mGracePeriode == '09' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF00') 
                                  )
                              )
                          );
                        } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FFFF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '4682B4') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2021'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '87CEFA') 
                                  )
                              )
                          );
                         } 
                         /*tahun 2022*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '7B68EE') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9370DB') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '8B008B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '04' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '9400D3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '05' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DDA0DD') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF00FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FAEBD7') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5DEB3') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FFFFE0') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BC8F8F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2022'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '708090') 
                                  )
                              )
                          );
                         } 
                         
                         
                         /* tahun 2023*/
                         else  if($mGracePeriode == '01' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E6E6FA') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F0F8FF') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '808080') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '800000') 
                                  )
                              )
                          );
                         }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'CD5C5C') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'E9967A') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'FF8C00') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'DAA520') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'BDB76B') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'D2691E') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '556B2F') 
                                  )
                              )
                          );
                         } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2023'){       
                          $excel->getActiveSheet()
                          ->getStyle('BJ2')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '00FF7F') 
                                  )
                              )
                          );
                         } 
                          /* tahun 2024*/
                          else  if($mGracePeriode == '01' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FF7F50') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '02' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E9967A') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '03' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FA8072') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '04' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'FFA500') 
                                      )
                                  )
                              );
                             }  else  if($mGracePeriode == '05' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'B8860B') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '06' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '808000') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '07' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '228B22') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '08' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '66CDAA') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '09' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'E0FFFF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '10' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4682B4') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '11' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '1E90FF') 
                                      )
                                  )
                              );
                             } else  if($mGracePeriode == '12' AND  $yGracePeriode == '2024'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => '4B0082') 
                                      )
                                  )
                              );
                             } 
  
                             /*tahun 2025 */
  
                             else  if($mGracePeriode == '01' AND  $yGracePeriode == '2025'){       
                              $excel->getActiveSheet()
                              ->getStyle('BJ2')
                              ->applyFromArray(
                                  array(
                                      'fill' => array(
                                          'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                          'color' => array('rgb' => 'F5F5F5') 
                                      )
                                  )
                              );
                             } 
                      if($payment == 100){
                          
                          $excel->getActiveSheet()
                          ->getStyle('BJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => '199904') /*hijau*/
                                  )
                              )
                          );
                        } else if ($payment >= 70){
            
                          $excel->getActiveSheet()
                          ->getStyle('BJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'F5E739') /*kuning*/
                                  )
                              )
                          );
            
                        } else if ($payment <= 39){
            
                          $excel->getActiveSheet()
                          ->getStyle('BJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'EC0B34') /*merah*/
                                  )
                              )
                          );
            
                        } else if ($payment >= 40){
            
                          $excel->getActiveSheet()
                          ->getStyle('BJ1')
                          ->applyFromArray(
                              array(
                                  'fill' => array(
                                      'type' => PHPExcel_Style_Fill::FILL_SOLID,
                                      'color' => array('rgb' => 'ffe6e6')
                                  )
                              )
                          );
            
                        }
                      break;  
                                                           
                  }
            }
        }
    }
    


      
    


      // Set width kolom
      $excel->getActiveSheet()->getColumnDimension('A')->setWidth(10); // Set width kolom A
      $letters = range('A', 'Z');

      foreach ($letters as $one) {
        $excel->getActiveSheet()->getColumnDimension($one)->setWidth(-1); // Set width kolom B
        $excel->getActiveSheet()->getRowDimension('1')->setRowHeight(-1);
        foreach ($letters as $two) {
          $excel->getActiveSheet()->getColumnDimension($one.''.$two)->setWidth(15); // Set width kolom B
          $excel->getActiveSheet()->getRowDimension('1')->setRowHeight(-1);  
        
        }
      }
      // Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)
      $excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);
  
      // Set orientasi kertas jadi LANDSCAPE
      $excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);
  
      // Set judul file excel nya
      $excel->getActiveSheet(0)->setTitle("Laporan Data Serah Terima");
      $excel->setActiveSheetIndex(0);
    

     // Proses file excel
     $filename = $tower.'_'.$level.'.xlsx'; 
     header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
     header("Content-Disposition: attachment; filename=$filename"); 
     header('Cache-Control: max-age=0');
 
     $write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');
     $write->save('php://output');

  }


  public function cekPenerimaan(){
    
  }
  
 
  
  public function export(){
  

    $month = $this->input->get('nmMonth');
		$year = $this->input->get('nmYear');
    $tower = $this->input->get('nmTower');
    
    // Panggil class PHPExcel nya
    $excel = new PHPExcel();




    $dataUnitlevel5 = $this->AlltowerModel->allDataUnitLevel5($month,$year,$tower);	
		$dataUnitlevel6 = $this->AlltowerModel->allDataUnitLevel6($month,$year,$tower);	
		$dataUnitlevel7 = $this->AlltowerModel->allDataUnitLevel7($month,$year,$tower);	
		$dataUnitlevel8 = $this->AlltowerModel->allDataUnitLevel8($month,$year,$tower);	
		$dataUnitlevel9 = $this->AlltowerModel->allDataUnitLevel9($month,$year,$tower);	
		$dataUnitlevel10 = $this->AlltowerModel->allDataUnitLevel10($month,$year,$tower);
		$dataUnitlevel11 = $this->AlltowerModel->allDataUnitLevel11($month,$year,$tower);	
    $dataUnitlevel12 = $this->AlltowerModel->allDataUnitLevel12($month,$year,$tower);	
		$dataUnitlevel15= $this->AlltowerModel->allDataUnitLevel15($month,$year,$tower);
		$dataUnitlevel16 = $this->AlltowerModel->allDataUnitLevel16($month,$year,$tower);	
		$dataUnitlevel17 = $this->AlltowerModel->allDataUnitLevel17($month,$year,$tower);	
		$dataUnitlevel18 = $this->AlltowerModel->allDataUnitLevel18($month,$year,$tower);	
		$dataUnitlevel19 = $this->AlltowerModel->allDataUnitLevel19($month,$year,$tower);	
		$dataUnitlevel20 = $this->AlltowerModel->allDataUnitLevel20($month,$year,$tower);	
		$dataUnitlevel21 = $this->AlltowerModel->allDataUnitLevel21($month,$year,$tower);	
		$dataUnitlevel22 = $this->AlltowerModel->allDataUnitLevel22($month,$year,$tower);	
		$dataUnitlevel23 = $this->AlltowerModel->allDataUnitLevel23($month,$year,$tower);	
		$dataUnitlevel24 = $this->AlltowerModel->allDataUnitLevel24($month,$year,$tower);	
		$dataUnitlevel25 = $this->AlltowerModel->allDataUnitLevel25($month,$year,$tower);
		$dataUnitlevel26 = $this->AlltowerModel->allDataUnitLevel26($month,$year,$tower);	
		$dataUnitlevel27 = $this->AlltowerModel->allDataUnitLevel27($month,$year,$tower);	
		$dataUnitlevel28 = $this->AlltowerModel->allDataUnitLevel28($month,$year,$tower);	
		$dataUnitlevel29 = $this->AlltowerModel->allDataUnitLevel29($month,$year,$tower);	
		$dataUnitlevel30 = $this->AlltowerModel->allDataUnitLevel30($month,$year,$tower);	
		$dataUnitlevel31 = $this->AlltowerModel->allDataUnitLevel31($month,$year,$tower);	
		$dataUnitlevel32 = $this->AlltowerModel->allDataUnitLevel32($month,$year,$tower);	
		$dataUnitlevel33 = $this->AlltowerModel->allDataUnitLevel33($month,$year,$tower);	
		$dataUnitlevel34 = $this->AlltowerModel->allDataUnitLevel34($month,$year,$tower);	
		$dataUnitlevel35 = $this->AlltowerModel->allDataUnitLevel35($month,$year,$tower);	
		$dataUnitlevel36 = $this->AlltowerModel->allDataUnitLevel36($month,$year,$tower);	
		$dataUnitlevel37 = $this->AlltowerModel->allDataUnitLevel37($month,$year,$tower);
		$dataUnitlevel38 = $this->AlltowerModel->allDataUnitLevel38($month,$year,$tower);	
		$dataUnitlevel39 = $this->AlltowerModel->allDataUnitLevel39($month,$year,$tower);	

    // Settingan awal fil excel
    $excel->getProperties()->setCreator('Koko')
                 ->setLastModifiedBy('Koko')
                 ->setTitle("Data Serah Terima")
                 ->setSubject("Siswa")
                 ->setDescription("Tokyo")
                 ->setKeywords("Data Serah Terima");

    // Buat sebuah variabel untuk menampung pengaturan style dari header tabel
    $style_col = array(
        'font' => array('bold' => true), // Set font nya jadi bold
        'alignment' => array(
        'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
        'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
      ),
      'borders' => array(
        'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis
        'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis
        'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis
        'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis
      )
    );

    // Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
    $style_row = array(
      'alignment' => array(
        'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
      ),
      'borders' => array(
        'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis
        'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis
        'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis
        'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis
      )
    );

    $excel->setActiveSheetIndex(0)->setCellValue('A1', "DATA UNIT TOKYO"); // Set kolom A1 dengan tulisan "DATA SISWA"
    $excel->getActiveSheet()->mergeCells('A1:E1'); // Set Merge Cell pada kolom A1 sampai E1
    $excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1
    $excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1
    $excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1

    // Buat header tabel nya pada baris ke 3
    $excel->setActiveSheetIndex(0)->setCellValue('A3', "Unit"); // Set kolom A3 dengan tulisan "NO"
    $excel->setActiveSheetIndex(0)->setCellValue('B3', "Jumlah"); // Set kolom B3 dengan tulisan "NIS"


    // Apply style header yang telah kita buat tadi ke masing-masing kolom header
    $excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_col);
    $excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_col);

    // Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya
   
    


    $numrow = 5;
    
    foreach($dataUnitlevel5 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 6;
    foreach($dataUnitlevel6 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 7;
    foreach($dataUnitlevel7 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 8;
    foreach($dataUnitlevel8 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 9;
    foreach($dataUnitlevel9 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 10;
    foreach($dataUnitlevel10 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 11;
    foreach($dataUnitlevel11 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 12;
    foreach($dataUnitlevel12 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 15;
    foreach($dataUnitlevel15 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 16;
    foreach($dataUnitlevel16 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 17;
    foreach($dataUnitlevel17 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 18;
    foreach($dataUnitlevel18 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 19;
    foreach($dataUnitlevel19 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 20;
    foreach($dataUnitlevel20 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 21;
    foreach($dataUnitlevel21 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 22;
    foreach($dataUnitlevel22 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 23;
    foreach($dataUnitlevel23 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 24;
    foreach($dataUnitlevel24 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 25;
    foreach($dataUnitlevel25 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 26;
    foreach($dataUnitlevel26 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 27;
    foreach($dataUnitlevel27 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 28;
    foreach($dataUnitlevel28 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 29;
    foreach($dataUnitlevel29 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 30;
    foreach($dataUnitlevel30 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 31;
    foreach($dataUnitlevel31 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 32;
    foreach($dataUnitlevel32 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 33;
    foreach($dataUnitlevel33 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 34;
    foreach($dataUnitlevel34 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 35;
    foreach($dataUnitlevel35 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 36;
    foreach($dataUnitlevel36 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 37;
    foreach($dataUnitlevel37 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }


    $numrow = 38;
    foreach($dataUnitlevel38 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }

    $numrow = 39;
    foreach($dataUnitlevel39 as $data){ 
      $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $data['lantai']);
      $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data['sumData']);
      $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style_row);
      $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style_row);
    }



    // Set width kolom
    $excel->getActiveSheet()->getColumnDimension('A')->setWidth(30); // Set width kolom A
    $excel->getActiveSheet()->getColumnDimension('B')->setWidth(10); // Set width kolom B

 
    
    // Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)
    $excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);

    // Set orientasi kertas jadi LANDSCAPE
    $excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);

    // Set judul file excel nya
    $excel->getActiveSheet(0)->setTitle("Laporan Data Serah Terima");
    $excel->setActiveSheetIndex(0);

    // Proses file excel
    $filename = $tower.'_'.$month.'_'.$year.'.xlsx'; 
    header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
    header("Content-Disposition: attachment; filename=$filename"); 
    header('Cache-Control: max-age=0');

    $write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');
    $write->save('php://output');
  }
}